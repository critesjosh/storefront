<!doctype html>
<html lang="en" dir="ltr">
<head>
<base href="."/>
<title>Storefront</title>
<meta charset="utf-8">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" ></script>

<script src="./app.js"></script>
</head>
<body ng-cloak ng-controller="storefrontController">

<div class="container-fluid">
	<div class="row">
		<div class="col-md-12">

		<h1>Etherbay</h1>
		<h2>Sell your stuff via the ethereum blockchain</h2>

		<p>How it works:</p>
		<p>Admins can add and remove products. Send me a tweet @critesjosh_ and I'll add your address to be an admin.</p>
		<p>Anyone can purchase products (as long as you have enough ethereum in your account).</p>


		<table>
          <tr>
            <td>
              <form id="StoreForm" ng-submit="newStore()">
                <input type="submit" class="btn btn-primary addnew" value="New Store"></h3>
              </form>
            </td>
            <td>        
              <h3>
                <form id="accountForm" ng-submit="setAccount()">
                  &nbsp;
                  <select name="account" ng-model="accountSelected" required>
                    <option ng-repeat="account in accounts" value="{{ account }}">
                    {{ account }}
                    </option>
                  </select>
                  <input type="submit" class="btn btn-primary" value="Select Account"></h3>
                </form>
              </h3>
            </td>
          </tr>
        </table>

        <form>
        	<select name="store" ng-model="storeSelected" required>
        		<option ng-repeat="store in ownedStores" value="{{ store }}">
        		{{ store }}
        		</option>
        	</select>
        	<input type="submit" class="btn btn-primary" value="Select Storefront">
        </form>






        

			<form id="addAdminForm" ng-submit="addAdmin()" ng-show="isOwner">
				<input type="text" name="newAdmin" ng-model="newAdmin" required placeholder="New admin address"/>
				<input type="submit" class="btn btn-primary" value="Add Admin"/>
			</form>

			<form id="addProductForm" ng-submit="addProduct()" ng-show="isAdmin">
				<input type="text" name="price" ng-model="price" required placeholder="Price (in wei)" />
				<input type="text" name="stock" ng-model="stock" required placeholder="Amount in stock" />
				<input type="submit" class="btn btn-primary" value="Add Product"/>
			</form>

			<form ng-submit="removeProduct()" ng-show="isAdmin">
				<input type="text" ng-model="toRemoveId" required placeholder="ID of product to remove"/>
				<input type="submit" class="btn btn-danger" value="Remove Product"/>
			</form>

			<div class="control-group" ng-repeat="product in formattedProducts track by $index">
				<div style="border:1px solid grey">
					<div>Product ID: {{ product.id }}</div>
					<div>Price: {{ product.price }} (wei)</div>
					<div>Amount in stock: {{ product.stock }}</div>
					<form class="controls">
						Quantity to purchase: <input type="text" name="quantity" ng-model="product.quantity" required />
					</form>
				</div>
				<br>
			</div>

			<input type="submit" class="btn btn-success" ng-click="purchaseProduct()" value="Purchase"/>


		</div>
	</div>
</div>
<script>
window.addEventListener('load', function(){
	angular.bootstrap(document, ['storefrontApp']);
});
	</script>

</body>


</html>
